# ğŸ“ ç‰›å¸‚é€‰è‚¡æ¨¡å— - æœ€ç»ˆæ•´ç†ç‰ˆ

## ğŸ—ï¸ ä¼˜é›…çš„ç›®å½•ç»“æ„

```
bull_market_agent/
â”œâ”€â”€ ğŸ“„ __init__.py                    # æ¨¡å—å¯¼å‡º + ä¾¿æ·å‡½æ•°
â”œâ”€â”€ ğŸ“„ core.py                        # é¢†åŸŸæ ¸å¿ƒå¯¹è±¡å’Œä¸šåŠ¡é€»è¾‘
â”œâ”€â”€ ğŸ“„ strategies.py                  # äº¤æ˜“ç­–ç•¥å®ç°
â”œâ”€â”€ ğŸ“„ backtesting.py                 # å†å²å›æµ‹å¼•æ“
â”œâ”€â”€ ğŸ“„ infrastructure.py              # åŸºç¡€è®¾æ–½å®ç°
â”œâ”€â”€ ğŸ“„ elegant_ui.py                  # ç°ä»£åŒ–ç”¨æˆ·ç•Œé¢
â”œâ”€â”€ ğŸ“ domain/                        # é¢†åŸŸå±‚å­æ¨¡å—
â”‚   â””â”€â”€ ğŸ“„ __init__.py               # é¢†åŸŸå¯¹è±¡é‡æ–°å¯¼å‡º
â”œâ”€â”€ ğŸ“ application/                   # åº”ç”¨å±‚å­æ¨¡å—
â”‚   â””â”€â”€ ğŸ“„ __init__.py               # ç”¨ä¾‹ç¼–æ’å’ŒDTO
â”œâ”€â”€ ğŸ“ tests/                         # æµ‹è¯•ç›®å½•
â”‚   â””â”€â”€ ğŸ“„ __init__.py               # æµ‹è¯•å·¥å…·å‡½æ•°
â”œâ”€â”€ ğŸ“„ DIRECTORY_STRUCTURE.md         # ç›®å½•ç»“æ„è¯´æ˜
â”œâ”€â”€ ğŸ“„ README.md                      # æ¨¡å—ä½¿ç”¨æŒ‡å—
â”‚
â”œâ”€â”€ ğŸ“„ ui.py                          # é—ç•™UI (å…¼å®¹)
â”œâ”€â”€ ğŸ“„ strategy.py                    # é—ç•™ç­–ç•¥ (å…¼å®¹)
â”œâ”€â”€ ğŸ“„ backtest.py                    # é—ç•™å›æµ‹ (å…¼å®¹)
â”œâ”€â”€ ğŸ“„ db.py                          # é—ç•™æ•°æ®åº“ (å…¼å®¹)
â”œâ”€â”€ ğŸ“„ bull_monitor_*.py             # é—ç•™ç›‘æ§æ¨¡å— (å…¼å®¹)
â”œâ”€â”€ ğŸ“„ log_*.py                       # é—ç•™æ—¥å¿—æ¨¡å— (å…¼å®¹)
â””â”€â”€ ğŸ“„ self_diagnose.py              # é—ç•™è¯Šæ–­æ¨¡å— (å…¼å®¹)
```

## ğŸ¯ æ¶æ„å±‚æ¬¡

### ğŸ§  **é¢†åŸŸå±‚ (Domain Layer)**
- **èŒè´£**: ä¸šåŠ¡è§„åˆ™ã€å®ä½“å¯¹è±¡ã€é¢†åŸŸæœåŠ¡
- **æ–‡ä»¶**: `core.py`, `domain/`
- **ç‰¹ç‚¹**: ä¸ä¾èµ–ä»»ä½•å¤–éƒ¨æ¡†æ¶ï¼Œæ˜¯ç³»ç»Ÿæ ¸å¿ƒ

### ğŸ¬ **åº”ç”¨å±‚ (Application Layer)**
- **èŒè´£**: ç”¨ä¾‹ç¼–æ’ã€åº”ç”¨æœåŠ¡ã€æ•°æ®ä¼ è¾“
- **æ–‡ä»¶**: `application/`
- **ç‰¹ç‚¹**: ç¼–æ’é¢†åŸŸå¯¹è±¡ï¼Œå¤„ç†ä¸šåŠ¡æµç¨‹

### ğŸ”Œ **åŸºç¡€è®¾æ–½å±‚ (Infrastructure Layer)**
- **èŒè´£**: å¤–éƒ¨æœåŠ¡é›†æˆã€æ•°æ®æŒä¹…åŒ–ã€é€šçŸ¥
- **æ–‡ä»¶**: `infrastructure.py`
- **ç‰¹ç‚¹**: å®ç°é¢†åŸŸå±‚å®šä¹‰çš„æ¥å£

### ğŸ¨ **è¡¨ç¤ºå±‚ (Presentation Layer)**
- **èŒè´£**: ç”¨æˆ·ç•Œé¢ã€æ•°æ®å±•ç¤ºã€äº¤äº’é€»è¾‘
- **æ–‡ä»¶**: `elegant_ui.py`, `ui.py`
- **ç‰¹ç‚¹**: è°ƒç”¨åº”ç”¨å±‚æœåŠ¡ï¼Œå¤„ç†ç”¨æˆ·äº¤äº’

### ğŸ§ª **æµ‹è¯•å±‚ (Testing Layer)**
- **èŒè´£**: å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•ã€æµ‹è¯•æ•°æ®
- **æ–‡ä»¶**: `tests/`
- **ç‰¹ç‚¹**: ä¿è¯ä»£ç è´¨é‡ï¼Œæ”¯æŒé‡æ„

## ğŸ”„ ä¾èµ–å…³ç³»

```
ğŸ¨ è¡¨ç¤ºå±‚ (elegant_ui.py)
    â†“ è°ƒç”¨
ğŸ¬ åº”ç”¨å±‚ (application/)
    â†“ ç¼–æ’
ğŸ§  é¢†åŸŸå±‚ (core.py + domain/)
    â†“ å®šä¹‰æ¥å£
ğŸ”Œ åŸºç¡€è®¾æ–½å±‚ (infrastructure.py)
    â†“ å®ç°æ¥å£
ğŸ§ª æµ‹è¯•å±‚ (tests/)
```

## ğŸ“¦ æ ¸å¿ƒæ¨¡å—è¯´æ˜

| æ¨¡å—æ–‡ä»¶ | èŒè´£ | é‡è¦æ€§ | ä¾èµ–å…³ç³» |
|----------|------|--------|----------|
| `__init__.py` | æ¨¡å—å¯¼å‡ºã€ä¾¿æ·å‡½æ•° | ğŸ”´ é«˜ | å¯¼å‡ºæ‰€æœ‰å…¬å…±API |
| `core.py` | é¢†åŸŸå¯¹è±¡ã€ä¸šåŠ¡é€»è¾‘ | ğŸ”´ é«˜ | ç³»ç»Ÿæ ¸å¿ƒï¼Œä¸ä¾èµ–å¤–éƒ¨ |
| `strategies.py` | ç­–ç•¥å®ç°ã€å·¥å‚ | ğŸŸ¡ ä¸­ | ä¾èµ–core.py |
| `backtesting.py` | å›æµ‹å¼•æ“ã€åˆ†æ | ğŸŸ¡ ä¸­ | ä¾èµ–core.py, strategies.py |
| `infrastructure.py` | å¤–éƒ¨æœåŠ¡é›†æˆ | ğŸŸ¡ ä¸­ | å®ç°core.pyå®šä¹‰çš„æ¥å£ |
| `elegant_ui.py` | ç°ä»£åŒ–ç•Œé¢ | ğŸŸ¢ ä½ | ä¾èµ–æ‰€æœ‰ä¸šåŠ¡æ¨¡å— |
| `domain/` | é¢†åŸŸå¯¹è±¡åˆ†ç»„ | ğŸŸ¢ ä½ | é‡æ–°å¯¼å‡ºcoreå¯¹è±¡ |
| `application/` | ç”¨ä¾‹ç¼–æ’ | ğŸŸ¢ ä½ | ç¼–æ’é¢†åŸŸå¯¹è±¡ |
| `tests/` | æµ‹è¯•æ”¯æŒ | ğŸŸ¢ ä½ | æä¾›æµ‹è¯•å·¥å…· |

## ğŸš€ ä½¿ç”¨æ¨¡å¼

### æ¨èç”¨æ³• (æ–°æ¶æ„)
```python
from bull_market_agent import create_analyzer

# ä¸€é”®åˆ›å»ºé…ç½®å¥½çš„åˆ†æå™¨
analyzer = create_analyzer(
    sectors=["BK0917", "BK0480"],
    confidence_threshold=80.0,
    enable_parallel=True
)

# ä½¿ç”¨åˆ†æå™¨
signals = analyzer.scan_market()
result = analyzer.run_backtest(start_date, end_date)
```

### é«˜çº§ç”¨æ³• (è‡ªå®šä¹‰ç»„ä»¶)
```python
from bull_market_agent import (
    AnalysisConfig, BullMarketAnalyzer,
    StrategyFactory, AKShareMarketDataProvider
)

# è‡ªå®šä¹‰é…ç½®å’Œç»„ä»¶
config = AnalysisConfig(...)
analyzer = BullMarketAnalyzer(
    config=config,
    data_provider=AKShareMarketDataProvider(),
    # ... å…¶ä»–è‡ªå®šä¹‰ç»„ä»¶
)
```

### UIç•Œé¢
```python
from bull_market_agent import run_elegant_ui
run_elegant_ui()  # å¯åŠ¨ç°ä»£åŒ–ç•Œé¢
```

## ğŸ·ï¸ æ–‡ä»¶åˆ†ç±»

### ğŸ¯ **æ ¸å¿ƒæ–‡ä»¶** (å¿…é¡»æŒæ¡)
- `__init__.py` - äº†è§£æ¨¡å—API
- `core.py` - ç†è§£é¢†åŸŸæ¨¡å‹
- `strategies.py` - å­¦ä¹ ç­–ç•¥æ¨¡å¼

### ğŸ”§ **æ‰©å±•æ–‡ä»¶** (æ ¹æ®éœ€è¦)
- `backtesting.py` - å›æµ‹é€»è¾‘
- `infrastructure.py` - å¤–éƒ¨é›†æˆ
- `elegant_ui.py` - ç•Œé¢å¼€å‘

### ğŸ“š **å‚è€ƒæ–‡ä»¶** (å¯é€‰)
- `domain/` - é¢†åŸŸå¯¹è±¡åˆ†ç»„
- `application/` - ç”¨ä¾‹ç¼–æ’
- `tests/` - æµ‹è¯•ç¤ºä¾‹

### ğŸ—‚ï¸ **é—ç•™æ–‡ä»¶** (å…¼å®¹æ€§)
- `ui.py`, `strategy.py`, `backtest.py` ç­‰
- ä¿ç•™ç”¨äºå‘åå…¼å®¹
- æ–°åŠŸèƒ½è¯·ä½¿ç”¨æ–°æ¶æ„æ–‡ä»¶

## ğŸ¨ è®¾è®¡äº®ç‚¹

### 1. **æ•´æ´æ¶æ„** (Clean Architecture)
```
ä¾èµ–æ–¹å‘ä»å¤–å‘å†…ï¼Œé¢†åŸŸå±‚ä¸ºæ ¸å¿ƒï¼Œä¸ä¾èµ–å¤–éƒ¨æ¡†æ¶
```

### 2. **ä¾èµ–å€’ç½®** (Dependency Inversion)
```
é«˜å±‚æ¨¡å—å®šä¹‰æ¥å£ï¼Œä½å±‚æ¨¡å—å®ç°æ¥å£
analyzer = BullMarketAnalyzer(data_provider=interface)
```

### 3. **ç­–ç•¥æ¨¡å¼** (Strategy Pattern)
```
æ˜“æ‰©å±•æ–°ç­–ç•¥ï¼š
class MyStrategy(BaseStrategy):
    def analyze_market_data(self, data, config):
        return TradingSignal(...)
```

### 4. **æ¨¡æ¿æ–¹æ³•** (Template Method)
```
æ ‡å‡†åŒ–å¤æ‚æµç¨‹ï¼š
class BacktestEngine:
    def run_backtest(self):
        self._validate_inputs()
        self._execute_simulation()
        self._calculate_metrics()
```

### 5. **å·¥å‚æ¨¡å¼** (Factory Pattern)
```
ç»Ÿä¸€å¯¹è±¡åˆ›å»ºï¼š
strategies = StrategyFactory.create_all_strategies()
```

## ğŸ“ˆ æ¼”è¿›è·¯å¾„

### Phase 1: å½“å‰çŠ¶æ€ âœ…
- åŸºç¡€æ¶æ„æ­å»ºå®Œæˆ
- æ ¸å¿ƒåŠŸèƒ½æ­£å¸¸è¿è¡Œ
- é—ç•™ä»£ç ä¿æŒå…¼å®¹

### Phase 2: æ¸è¿›è¿ç§» ğŸš§
- æ–°åŠŸèƒ½ä½¿ç”¨æ–°æ¶æ„
- é€æ­¥é‡æ„é—ç•™ä»£ç 
- å®Œå–„æµ‹è¯•è¦†ç›–

### Phase 3: å®Œå…¨ç°ä»£åŒ– ğŸ¯
- ç§»é™¤æ‰€æœ‰é—ç•™ä»£ç 
- æ·±åº¦ä¼˜åŒ–æ€§èƒ½
- æ‰©å±•æ›´å¤šåŠŸèƒ½

## ğŸ¯ æ€»ç»“

è¿™æ˜¯ä¸€ä¸ª**ä¼˜é›…çš„æ¨¡å—åŒ–è®¾è®¡**ï¼Œæ—¢ä¿è¯äº†**å‘åå…¼å®¹æ€§**ï¼Œåˆä¸º**æœªæ¥æ‰©å±•**å¥ å®šäº†åšå®åŸºç¡€ã€‚ä»£ç ç»“æ„æ¸…æ™°ã€èŒè´£åˆ†æ˜ã€æ˜“äºç»´æŠ¤ï¼Œæ˜¯è¿½æ±‚**ä»£ç ç¾å­¦**çš„å…¸èŒƒå®ç°ï¼

**ğŸš€ è®©é‡åŒ–äº¤æ˜“ç³»ç»Ÿçš„ä»£ç åƒè‰ºæœ¯å“ä¸€æ ·ä¼˜é›…ï¼**